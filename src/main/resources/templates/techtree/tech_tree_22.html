<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>전공 이수 체계도</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leader-line/1.0.7/leader-line.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Montserrat', sans-serif;
      background-color: #f7f9fc;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    header {
      background-color: white;
      padding: 20px;
      box-shadow: 0 4px 4px rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #e2e8f0;
    }
    h1 {
      font-size: 2.3rem;
      font-weight: bold;
      color: #2563eb;
      margin: 0;
    }
    h1 a {
      text-decoration: none;
      color: inherit;
    }
    nav a {
      margin-left: 20px;
      text-decoration: none;
      color: #333;
      font-weight: 500;
    }
    nav a:hover {
      color: #3b82f6;
    }
    .grid-container {
      display: flex;
      flex-direction: column;
      gap: 20px;
      max-width: 1200px;
      margin: 50px auto;
      position: relative;
    }
    .year-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: #ddd;
      border-radius: 20px;
      padding: 10px;
      font-size: 1.1rem;  /* 원하는 크기로 조정! */
    }
    .year{
      font-size: 1.3rem;
      font-weight: bold;
    }
    .semester-container {
      display: flex;
      flex-direction: row;
      justify-content: center;
      gap: 15px;
      background-color: #bbb;
      padding: 10px;
      border-radius: 10px;
      width: 100%;
      flex-wrap: wrap;
    }

    .course {
      background-color: white;
      border: 2px solid black;
      padding: 15px;
      text-align: center;
      font-weight: bold;
      border-radius: 12px;
      min-width: 100px;
      transition: opacity 0.3s;

    }
    .flex-center-header {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 40px;
      margin: 20px auto;
      text-align: center;
    }
    .flex-center-header h1 {
      font-size: 2rem;
      font-weight: bold;
      margin: 0;
      color: #111;
    }
    .legend {
      display: flex;
      gap: 16px;
      align-items: center;
      font-size: 14px;
    }
    .legend-item {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .legend-box {
      width: 16px;
      height: 16px;
      border-radius: 4px;
      border: 1px solid black;
    }
    .legend-bsm {
      background-color: #ffeb3b;
    }
    .legend-design {
      background-color: #1d7bc5;
    }
    .legend-thick {
      width: 16px;
      height: 16px;
      border: 4px solid black;
      background-color: white;
      border-radius: 4px;
    }
    .bsm { /* 노랑 */
      border-color: #fff100 !important;
      border-width: 3px !important;
    }
    .design {
      border-color: #125a8e !important;
      border-width: 3px !important;
    }
    .advanced {
      border-width: 5px !important;
      border-style: double !important;
    }
    .course.design.advanced {
      border-color: #125a8e !important;
      border-style: double !important;
    }
    .dimmed {
      opacity: 0.2;
    }

    footer {
      background-color: rgba(30, 30, 30, 0.98);
      color: rgba(200, 200, 200, 0.7);
      font-size: 0.9rem;
      padding: 2rem 1rem;
      text-align: center;
      border-top: 1px solid #444;
      margin-top: auto;
    }
    footer a {
      text-decoration: none;
      color: rgba(200, 200, 200, 0.7);
      margin: 0 10px;
    }
    footer a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
<header>
  <h1><a href="/static">SMULET</a></h1>
  <nav>
    <a href="#"><b>이용안내</b></a>
    <a href="/Register"><b>회원가입</b></a>
  </nav>
</header>

<div class="flex-center-header">
  <h1>전공 이수 체계도(22학번)</h1>
  <div class="legend">
    <div class="legend-item">
      <div class="legend-box legend-bsm"></div><span>BSM</span>
    </div>
    <div class="legend-item">
      <div class="legend-box legend-design"></div><span>설계</span>
    </div>
    <div class="legend-item">
      <div class="legend-thick"></div><span>전공 심화</span>
    </div>
  </div>
</div>

<div class="grid-container" id="grid">
  <div class="year-container">
    <div class = 'year'>1학년</div>
    <div class="semester-container">
      <div class = "semester-label">1학기</div>
      <div class="course bsm" data-subject="컴퓨터수학">컴퓨터수학</div>
      <div class="course" data-subject="파이썬 프로그래밍">파이썬 프로그래밍</div>
    </div>
    <div class="semester-container">
      <div class = "semester-label">2학기</div>
      <div class="course design" data-subject="공학설계입문">공학설계입문</div>
      <div class="course" data-subject="C프로그래밍 I">C프로그래밍 I</div>
      <div class="course bsm" data-subject="선형대수학 I">선형대수학 I</div>
    </div>
  </div>
  <div class="year-container">
    <div class = 'year'>2학년</div>
    <div class="semester-container">
      <div class = "semester-label">1학기</div>
      <div class="course" data-subject="C프로그래밍 II">C프로그래밍 II</div>
      <div class="course" data-subject="자료구조">자료구조</div>
      <div class="course bsm" data-subject="이산수학">이산수학</div>
      <div class="course design" data-subject="논리회로">논리회로</div>
      <div class="course bsm" data-subject="선형대수학 II">선형대수학 II</div>
    </div>
    <div class="semester-container">
      <div class = "semester-label">2학기</div>
      <div class="course" data-subject="객체지향 프로그래밍">객체지향 프로그래밍</div>
      <div class="course" data-subject="데이터베이스">데이터베이스</div>
      <div class="course" data-subject="알고리즘">알고리즘</div>
      <div class="course bsm" data-subject="통계적분석">통계적분석</div>
      <div class="course design" data-subject="시스템 소프트웨어">시스템 소프트웨어</div>
      <div class="course" data-subject="컴퓨터구조">컴퓨터구조</div>
      <div class="course" data-subject="정보보호">정보보호</div>
    </div>
  </div>
  <div class="year-container">
    <div class = 'year'>3학년</div>
    <div class="semester-container">
      <div class = "semester-label">1학기</div>
      <div class="course design advanced" data-subject="소프트웨어공학">소프트웨어공학</div>
      <div class="course advanced" data-subject="운영체제">운영체제</div>
      <div class="course" data-subject="데이터모델링과마이닝">데이터모델링과마이닝</div>
      <div class="course advanced" data-subject="인공지능">인공지능</div>
      <div class="course advanced" data-subject="컴퓨터네트워크">컴퓨터네트워크</div>
      <div class="course" data-subject="디지털 신호처리">디지털 신호처리</div>
    </div>
    <div class="semester-container">
      <div class = "semester-label">2학기</div>
      <div class="course advanced" data-subject="고급객체지향프로그래밍">고급객체지향프로그래밍</div>
      <div class="course" data-subject="사용자인터페이스">사용자인터페이스</div>
      <div class="course" data-subject="GPU 프로그래밍">GPU 프로그래밍</div>
      <div class="course" data-subject="분산시스템">분산시스템</div>
      <div class="course advanced" data-subject="프로그래밍 언어론">프로그래밍 언어론</div>
      <div class="course advanced" data-subject="유닉스 프로그래밍">유닉스 프로그래밍</div>
      <div class="course" data-subject="데이터 통신">데이터 통신</div>
      <div class="course advanced" data-subject="암호학">암호학</div>
    </div>
  </div>
  <div class="year-container">
    <div class = 'year'>4학년</div>
    <div class="semester-container">
      <div class = "semester-label">1학기</div>
      <div class="course design" data-subject="캡스톤디자인 I">캡스톤디자인 I</div>
      <div class="course design" data-subject="빅데이터응용">빅데이터응용</div>
      <div class="course" data-subject="클라우드 프로그래밍">클라우드 프로그래밍</div>
      <div class="course" data-subject="네트워크보안">네트워크보안</div>
    </div>
    <div class="semester-container">
      <div class = "semester-label">2학기</div>
      <div class="course design" data-subject="캡스톤디자인 II">캡스톤디자인 II</div>
      <div class="course" data-subject="클라우드 플랫폼">클라우드 플랫폼</div>
      <div class="course" data-subject="컴파일러">컴파일러</div>
      <div class="course" data-subject="ICT 학점이수 인턴제">ICT 학점이수 인턴제</div>
    </div>
  </div>

</div>

<footer>
  <b>
    <a href="#">Github</a>
    <a href="#">개인정보처리방침</a>
    <a href="#">이용약관</a><br><br>
    <a href="#">Copyright</a>
  </b>
</footer>

<script>
  const groups = {
    pink: ['공학설계입문', '소프트웨어공학', '캡스톤디자인 I', '캡스톤디자인 II'],
    green: ['파이썬 프로그래밍', 'C프로그래밍 I', 'C프로그래밍 II', '객체지향 프로그래밍', '고급객체지향프로그래밍', '캡스톤디자인 I', '캡스톤디자인 II'],
    purple: ['선형대수학 I', '선형대수학 II', '디지털 신호처리'],
    orange: ['파이썬 프로그래밍', 'C프로그래밍 I', 'C프로그래밍 II', '시스템 소프트웨어', '운영체제', '유닉스 프로그래밍'],
    navy: ['파이썬 프로그래밍', 'C프로그래밍 I', 'C프로그래밍 II', '자료구조', '데이터베이스', '데이터모델링과마이닝', '빅데이터응용'],
    mint: ['이산수학', '프로그래밍 언어론', '컴파일러'],
    gray: ['파이썬 프로그래밍', 'C프로그래밍 I', 'C프로그래밍 II', '시스템 소프트웨어', '운영체제', '유닉스 프로그래밍'],
    cobalt: ['선형대수학 I', '선형대수학 II', '인공지능'],
    brown: ['정보보호', '암호학', '네트워크보안'],
    red: ['클라우드 프로그래밍', '클라우드 플랫폼'],
    gold: ['컴퓨터네트워크', '데이터 통신'],
    wine: ['통계적 분석', '인공지능'],
    coral: ['자료구조', '알고리즘'],
    beige: ['이산수학', '알고리즘'],
    orchid: ['논리회로', '컴퓨터구조'],
  };

  const allCourses = document.querySelectorAll('.course');
  let activeLines = [];

  function findGroup(subjectName) {
    return Object.values(groups).find(group => group.includes(subjectName));
  }

  function drawLines(groupNames) {
    const lines = [];
    for (let i = 0; i < groupNames.length - 1; i++) {
      const from = document.querySelector(`[data-subject="${groupNames[i]}"]`);
      const to = document.querySelector(`[data-subject="${groupNames[i + 1]}"]`);
      if (from && to) {
        const fromYear = from.closest('.year-container');
        const toYear = to.closest('.year-container');
        const isSameYear = fromYear === toYear;

        let line;
        if (isSameYear) {
          // 같은 학년이면서 좌우로 붙어있는 경우 체크
          const fromRect = from.getBoundingClientRect();
          const toRect = to.getBoundingClientRect();
          const isSideBySide = Math.abs(fromRect.top - toRect.top) < 30 && Math.abs(fromRect.right - toRect.left) < 150;
          if (isSideBySide) {
            // 오른쪽 방향 연결
            line = new LeaderLine(
                    LeaderLine.pointAnchor(from, { x: '98%', y: '50%' }),
                    LeaderLine.pointAnchor(to, { x: '2%', y: '50%' }),
                    {
                      color: 'black',
                      size: 2,
                      path: 'straight', // 그대로 직선
                      startPlug: 'behind',
                      endPlug: 'arrow1',
                      startSocket: 'right',
                      endSocket: 'left',
                    }
            );
          } else {
            // 세로 연결은 기존대로
            line = new LeaderLine(
                    LeaderLine.pointAnchor(from, { x: '50%', y: '100%' }),
                    LeaderLine.pointAnchor(to, { x: '50%', y: '0%' }),
                    {
                      color: 'black',
                      size: 2,
                      path: 'straight',
                      startPlug: 'behind',
                      endPlug: 'arrow1',
                      startSocket: 'bottom',
                      endSocket: 'top',
                    }
            );
          }
        } else {
          // 다른 학년이면 세로 grid 연결
          line = new LeaderLine(
                  LeaderLine.pointAnchor(from, { x: '50%', y: '100%' }),
                  LeaderLine.pointAnchor(to, { x: '50%', y: '0%' }),
                  {
                    color: 'black',
                    size: 2,
                    path: 'grid',
                    startPlug: 'behind',
                    endPlug: 'arrow1',
                    startSocket: 'bottom',
                    endSocket: 'top',
                  }
          );
        }
        lines.push(line);
      }
    }
    return lines;
  }

  allCourses.forEach(course => {
    course.addEventListener('mouseenter', () => {
      const subject = course.dataset.subject;
      const group = findGroup(subject);
      if (group) {
        allCourses.forEach(el => {
          if (group.includes(el.dataset.subject)) {
            el.classList.remove('dimmed');
          } else {
            el.classList.add('dimmed');
          }
        });
        activeLines = drawLines(group);
      }
    });

    course.addEventListener('mouseleave', () => {
      allCourses.forEach(el => el.classList.remove('dimmed'));
      activeLines.forEach(line => line.remove());
      activeLines = [];
    });
  });
  document.addEventListener('DOMContentLoaded', function () {
    const token = localStorage.getItem('jwtToken');

    if (!token) {
      alert("로그인이 필요합니다.");
      window.location.href = "/login";
    }
  });
</script>
</body>
</html>
